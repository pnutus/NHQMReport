\documentclass[../main/report.tex]{subfiles}
\begin{document}

\chapter{The Complex Berggren Basis}
\label{cha:berggren}
As was argued in the introduction, resonances can only be properly described by a complex energy, $E=E_0-i\frac{\Gamma}{2}$. 
We may relate the energy of a system to a momentum, according to
\begin{eq}
  E = \frac{\hbar^2 k^2}{2\mu}
  \quad\quad
  \textup{or}
  \quad\quad
  k = \frac{\sqrt{2\mu E}}{\hbar},
\end{eq} \todo{Perhaps add a discussion/motivation of this ''definition''? See .tex for more info}
%Reason behind E=k^2/2m : schrödinger equation says Hu = Eu, H=k^2/2m + V(r), open system => finite range on the potential, meaning V(r) mostly 0.
%(This is especially true for unbound solutions that mostly live far away from the core)
%Therefore, far away from the core (''in the lab''?) all solutions satisfy (k^2/2m)u = Eu, because V(r) = 0, making it a reasonable (?) definition
%Should something along these lines be included? 
This tells us that the resonant states have complex momenta and that we have to extend the plane wave basis into the complex momentum plane in order to find them.
To clarify what this means, consider again the Schrödinger equation in momentum representation, \cref{eq:radial mom space TISE}:\todo{Momentum space Schrödinger equation? Plane wave SE? Spherical wave SE?}
\begin{eq}
  \frac{k^2}{2\mu}\phi(k) + \fint[0][\inf]{k} k'^2 V(k,k') \phi(k') 
  &=
  E\phi(k) \, .
\end{eq}
Using a complex momentum basis effectively means that we instead evaluate the integral along a complex contour. 
In 1968, Berggren\cite{berggren} first showed that the solutions --- bound states, resonant states and the non-resonant continuum --- that are obtained using this scheme form a complete orthonormal basis. 
This is a major result, meaning that resonances are included as proper solutions to open quantum systems. This will be of importance later, when we consider systems of multiple interacting particles. 
In this Chapter, we will instead focus on using contours in the complex momentum plane to find the resonances of \He{5}.

To find the resonance, the contour is required to pass below the pole corresponding to the resonance. \todo{Should we say that it is required, or just investigate different contours and find out?}
A sample contour that could be used is visualized in \cref{fig:berggren contour}. %Note that the solutions in the complex plane are mirrored in the y-axis. \todo{why is this important? elaborate further?}

\begin{figure}
  \tikzset{
    triangle/.style={regular polygon, regular polygon sides=3},
    nosep/.style={inner sep=0},
    bound/.style={circle,draw,minimum size=2mm,nosep},
    unbound/.style={rectangle,draw,minimum size=2mm,nosep},
    quasibound/.style={triangle,draw,minimum size=2.5mm,nosep}
  }
  \subfloat[]{
  \label{fig:simple contour}
  %\tikzset{external/remake next}
\tikzsetnextfilename{simple_contour}
  \begin{tikzpicture}[scale = 2.5]
    \draw[->] (-1.2, 0) -- (1.2, 0) node[right] {$\Re k$};
    \draw[->] (0, -0.5) -- (0, 1.2) node[above] {$\Im k$};
    \foreach \y in {0.1, 0.3}
      \node at (0, \y) [bound] {};
    \foreach \x in {0.25, -0.25}
      \node at (\x, -0.15) [quasibound] {};
    \draw[very thick, mid arrows] (1, 0) arc (0:90:1) arc (90:180:1) 
                                  -- (0,0) -- cycle;
  \end{tikzpicture}
  }
  \subfloat[]{
  \label{fig:berggren contour}
  %\tikzset{external/remake next}
\tikzsetnextfilename{berggren_contour}
  \begin{tikzpicture}[scale = 2.5]
    \draw[->] (-1.2, 0) -- (1.2, 0) node[right] {$\Re k$};
    \draw[->] (0, -0.5) -- (0, 1.2) node[above] {$\Im k$};
    \foreach \y in {0.1, 0.3}
      \node at (0, \y) [bound] {};
    \foreach \x in {0.25, -0.25}
      \node at (\x, -0.15) [quasibound] {};
    \draw[very thick, mid arrows, radius=1]
      (1, 0) arc [start angle=0,  end angle=90]
             arc [start angle=90, end angle=180]
             -- (-0.5, 0) 
             -- (-0.25, 0.25) 
             -- (0.25, -0.25)
             -- (0.5, 0)
             -- cycle;
  \end{tikzpicture}
  }
  \caption{The complex $k$-plane. The circles represent 
  bound states and the triangles resonant states. Note the 
  mirroring of the states in the imaginary axis.}
  \label{fig:complex plane}
\end{figure}

\todo{Need to mention completeness of berggren basis. Important here or later?}

\todo{Where to put: "No conjugate on bras"?}

\section{The Complex Contour}
\todo{In this section I will add additional context and connect it better with previous section}
We choose to extend our integration along the real axis to 
the simplest possible complex contour, a triangle-shaped downward extrusion. 
The tip of the triangle is placed below the hypothesized resonance.

We are faced with the problem of evaluating this contour integral numerically. 
We can solve this by considering each straight segment of the contour separately 
and rescale the integration variable so that they are written as integrals along the real line.
We may then use the standard Gauss-Legendre quadrature to calculate the contributions from each segment.
An example of a contour is seen in
\cref{fig:triangle contour}, marking each point where the integrand is evaluated. Note the concentration of points near the ends of each segment, resulting from the GL-quadrature.
With this procedure, we once again get the Schrödinger equation on the same discretized form as \cref{eq:plane wave matrix elements}:
\begin{eq}
  H_{ij}' = \frac{k_i^2}{2\mu}\delta_{ij} + \sqrt{w_i w_j}k_i k_j V_{ij} \, ,
  \label{eq:nhqm matrix element}
\end{eq}
but now with complex $k$ and $w$.

%\tikzset{external/remake next}
\tikzsetnextfilename{triangle_contour}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      width = \textwidth,
      height = 7cm,
      xlabel=Re $k$,
      ylabel=Im $k$,
		  axis lines = middle,
      ymax = 0.1,
      enlargelimits,
      only marks,
      ticks = none,
      ]
      \addplot table {../figures/numerical_contour/numerical_contour.data};
    \end{axis}
  \end{tikzpicture}
  \caption{The complex contour used. The points are distributed on each segment according to the Gauss-Legendre quadrature rule.}
  \label{fig:triangle contour}
\end{figure}

\section{Studying the Resonance}
Armed with this we can continue our study of the \He{5} spectrum. 
Diagonalizing the matrix given by \cref{eq:nhqm matrix element} using a complex contour with vertices $k_0 = 0$, $k_1 = 0.2 - i0.1$, $k_2 = 2.5$ 
with 5 points on each segment, yields the result shown in \cref{fig:simple resonance}\todo{Create this figure.}. 
The same Woods-Saxon parameters have been used as before, and we represent the solutions by their momenta, $k=\sqrt{2\mu E}$, corresponding to the eigenvalues. 
We can see that we obtain solutions almost corresponding to the $k$-values used in the discretization, similar to what was found in the real case. 
These are once again interpreted as unbound solutions, not interacting strongly with the potential. 

The interesting solution is however the one not lying on the contour. If this solution is the resonance, we expect it to be unchanged when the contour is varied. Indeed, any contour passing below the resonance should give this solution. Solutions from various contours are shown in \cref{fig:pole(cont)}, demonstrating that this is the case.

In addition we can investigate the wavefunctions of these solutions. 
\Cref{fig:mom wavefunctions}\todo{Create this figure. SPILL?} shows the momentum distribution of an arbitrary unbound solution and the resonance. 
As is expected, the unbound solution basically correspond to one definite momentum. 
On the other hand, the resonance has a broad distribution, reflecting the localized nature of the solution 
(remember Heisenberg -- a broad momentum wavefunction allows a localized position wavefunction). 
In principle, this feature also gives us a way to automatically find the resonance among a large set of solutions: 
simply single out the one with the broadest wavefunction, or equivalently after normalization, with the lowest maximum value.
\todo{Perhaps this should only be in the two-body chapter} 

We can now properly investigate how the solutions change as the potential is varied. \Cref{fig:pole(V0)} shows how the solutions vary as $V_0$ 
is successively changed from \SI{70}{MeV}, where the potential well can contain a bound state, to \SI{50}{MeV} where no bound states exist. 
As the potential well grows less attractive, we see that the imaginary part $\Gamma$ of the resonance energy increases, and thus the half-time of the quasi-bound state becomes shorter.  

We may now proceed to fit our model of \He{5} to experimental data of the $p_{3/2}$ and  $p_{1/2}$ resonance provided by \cite{inte jimmy i alla fall}, giving values 

\todo{Make tables? One table showing all?}
$p_{3/2}: E_0 = bla bla, \Gamma = bla bla$

$p_{1/2}: E_0 = bla bla, \Gamma = bla bla$ 

Fitting the parameters $V_0$ and $V\sub{so}$ to these four data points give a best fit when

$V_0 = bla$

$V\sub{so} = bla$

where we get the calculated values $bla bla$ for the $p_{3/2}$ resonance and $bla bla$ for the $p_{1/2}$ resonance.

%\tikzset{external/remake next}
\tikzsetnextfilename{pole(V0)}
\begin{figure}
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      width = \textwidth,
      height = 9cm,
        xlabel=Re $k/\b{\si{fm^{-1}}}$,
        ylabel=Im $k/\b{\si{fm^{-1}}}$,
  		  axis x line = middle,
        axis y line = left,
        every axis y label/.style={
          at = {(current axis.above origin)},
          anchor = north west,
        },
        every axis x label/.style={
          at = {(current axis.right of origin)},
          anchor = north east,
        },
 	      yticklabel style={/pgf/number format/fixed,
 	                     /pgf/number format/precision=3},
        every x tick label/.append style = {anchor = south, yshift = 3pt},
        xmax=0.5,
        ytickmax = 0.3, xtickmax = 0.9,
        enlarge y limits,
        no markers,
        ]
      	\addplot+[very thick, ->] table  {../figures/res_pole(V0)/poles.data};
      	    \addlegendentry{Pole position}
      	\addplot+[very thick] table {../figures/res_pole(V0)/contour.data};
          \addlegendentry{Contour}
      \end{axis}
  \end{tikzpicture}
  \caption{The pole position as a function of $V_0$.}
  \label{fig:pole(V0)}

\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%V0 (CONTOUR) FIGURE
  
\begin{figure}
   \centering{
   \pgfplotsset{
     width = \textwidth,
     height = 7cm,
     axis lines = middle,
     xmin = -0.01, xmax = 0.5,
     xtickmin = 0.15,
     max space between ticks=60pt
     enlargelimits,
     ylabel=Im $k/\b{\si{fm^{-1}}}$,
     every axis y label/.style={
     at = {(current axis.above origin)},
     anchor = north west,
     },
     yticklabel style={/pgf/number format/fixed,
     /pgf/number format/precision=3},
     every axis x label/.style={
     at = {(current axis.right of origin)},
     anchor = north,
     },
     every x tick label/.append style = {anchor = south, yshift = 3pt},
   }
     \subfloat[Square Contour]{
       \tikzset{external/remake next}
   \tikzsetnextfilename{sqrcont}
       \begin{tikzpicture}
         \begin{axis}[
			 ymax = 0.04,
			 legend style={at={(0.6,0.4)}, anchor=north,legend columns=1},
			 xlabel=Re $k/\b{\si{fm^{-1}}}$]
         	\addplot+[only marks,very thick] table [x index =2, y index =3] {../figures/poles(contour)/square.data};
         	    \addlegendentry{Pole position}
         	\addplot+[no marks, very thick] table [x index =0, y index =1] {../figures/poles(contour)/square.data};
             \addlegendentry{Contour}
 
         \end{axis}
       \end{tikzpicture}
     }
 
   \subfloat[Triangle Contour]{
     \tikzset{external/remake next}
 \tikzsetnextfilename{trigcont}
     \begin{tikzpicture}
       \begin{axis}[
		   ymax = 0.04,
		   legend style={at={(0.8,0.2)}, anchor=north,legend columns=1},
		   xlabel=Re $k/\b{\si{fm^{-1}}}$]
         	\addplot+[only marks, very thick] table [x index =2, y index =3] {../figures/poles(contour)/triangle.data};
         	    \addlegendentry{Pole position}
         	\addplot+[no marks, very thick] table [x index =0, y index =1] {../figures/poles(contour)/triangle.data};
			             \addlegendentry{Contour}

       \end{axis}
     \end{tikzpicture}
   }
   
 %   \subfloat[Sierpinski Contour]{
 %     \tikzset{external/remake next}
 % \tikzsetnextfilename{sierpcont}
 %     \begin{tikzpicture}
 %       \begin{axis}[
 % 		   ymax = 0.04,
 % 		   legend style={at={(0.8,0.2)}, anchor=north,legend columns=1},
 % 		   xlabel=Re $k/\b{\si{fm^{-1}}}$]
 %         	\addplot+[only marks, very thick] table [x index =2, y index =3] {../figures/poles(contour)/sierpinski.data};
 %         	    \addlegendentry{Pole position}
 %         	\addplot+[no marks, very thick] table [x index =0, y index =1] {../figures/poles(contour)/sierpinski.data};
 % 			             \addlegendentry{Contour}
 % 
 %       \end{axis}
 %     \end{tikzpicture}
 %   }
   }
  \caption{yadayoda} 
  \label{fig:pole(cont)}  
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%V0 (CONTOUR) end


%%%%%%%%%%%%%%%%%%%REAL CONTOUR FIGURE

\begin{figure}[H] %this figure needs to be nudged a little bit to the left
   \centering{
   \pgfplotsset{
          width = 0.45\textwidth,
      height = 7cm,
 	  axis lines = middle,
       xmax = 0.5,
	   ymax = 0.5,
	   xmin = -0.01,
	   xtickmin = 0.15,
	   max space between ticks=60pt
       enlargelimits,
       ylabel=Im $k/\b{\si{fm^{-1}}}$,
       every axis y label/.style={
         at = {(current axis.above origin)},
         anchor = north west,
       },
	   yticklabel style={/pgf/number format/fixed,
	                     /pgf/number format/precision=2},
       every axis x label/.style={
         at = {(current axis.right of origin)},
         anchor = north,
       },
       every x tick label/.append style = {anchor = south, yshift = 3pt},
   }
     \subfloat[Real Contour \SI{-70}{MeV}]{
       %\tikzset{external/remake next}
   \tikzsetnextfilename{realcont70}
       \begin{tikzpicture}
         \begin{axis}[
  		   legend style={at={(0.8,0.5)}, anchor=north,legend columns=1},
  		   xlabel=Re $k/\b{\si{fm^{-1}}}$]
           	\addplot+[only marks, very thick] table [x index =0, y index =1] {../figures/poles(realcontour)/poles.data};
           	    \addlegendentry{Pole position}
           	\addplot+[no marks, very thick] table [x index =0, y index =1] {../figures/poles(realcontour)/contour.data};
  			             \addlegendentry{Contour}

         \end{axis}
       \end{tikzpicture}
     }
     \subfloat[Real Contour \SI{-50}{MeV}]{
       %\tikzset{external/remake next}
   \tikzsetnextfilename{realcont50}
       \begin{tikzpicture}
         \begin{axis}[
  		   legend style={at={(0.8,0.5)}, anchor=north,legend columns=1},
  		   xlabel=Re $k/\b{\si{fm^{-1}}}$]
           	\addplot+[only marks, very thick] table [x index =2, y index =3] {../figures/poles(realcontour)/poles.data};
           	    \addlegendentry{Pole position}
           	\addplot+[no marks, very thick] table [x index =0, y index =1] {../figures/poles(realcontour)/contour.data};
  			             \addlegendentry{Contour}

         \end{axis}
       \end{tikzpicture}
     }
   
   }
  \caption{momentum solutions to the Shrödinger equation ``along'' the real axis for \He{5} with a potential of $V_0 =$ \SI{-70}{MeV} (a) and $V_0 =$ \SI{-50}{MeV} (b).} 
   \label{fig:pole real contour}  
\end{figure}
\todo{define pole - momentum solution}
%%%%%%%%%%%%%%%%%%%REAL CONTOUR FIGURE end


\end{document}
