\documentclass[../main/report.tex]{subfiles}
\begin{document}

\chapter{The Complex-Momentum Basis}
\label{cha:berggren}
\todo{read through OLA SPILL}
In \cref{cha:two-body} we studied the \He{5} system and found a special state in the continuum, the resonance.
We will in this chapter detail a method of extending the momentum basis to the complex plane, which gives a more complete description of resonances. 
The \He{5} problem is then examined once more using this new tool and we fit the model parameters to experimental resonance data.

\section{The Complex Momentum Plane}

When solving the Schrödinger equation in the momentum basis, we know that the solutions form a complete basis, expressed as a completeness relation
\begin{eq}
  \label{eq:momentum_completeness_relation}
  \sum\sub{bound} \ket{E_n}\bra{E_n} + \fint[0][\inf]{k} k^2 \ket{E_k}\bra{E_k} = 1,
\end{eq}
where $E_n$ are discrete bound states and $E_k$ are continuous.

If we relate the energies $E$ to momenta $k$ as
\begin{eq}
  E = \frac{\hbar^2 k^2}{2\mu}
  \quad\quad
  \textup{or}
  \quad\quad
  k = \frac{\sqrt{2\mu E}}{\hbar},
\end{eq}
we can plot the solutions as $k$ in the complex plane, see 
\cref{fig:complex plane}. 
We then expect bound states, with $E<0$, to be represented by discrete $k$ along the imaginary axis---whereas unbound states with $E>0$, are found continuously along the real axis. 
Resonance states, with complex $E = E_0 - i \Gamma /2$, would by this argument appear somewhere in the fourth quadrant.

\begin{figure}
  \tikzset{
    triangle/.style={regular polygon, regular polygon sides=3},
    nosep/.style={inner sep=0},
    bound/.style={circle,draw,minimum size=2mm,nosep},
    unbound/.style={rectangle,draw,minimum size=2mm,nosep},
    quasibound/.style={triangle,draw,minimum size=2.5mm,nosep}
  }
  \centering{
    \subfloat[]{
    \label{fig:simple_contour}
    %\tikzset{external/remake next}
  \tikzsetnextfilename{simple_contour}
    \begin{tikzpicture}[scale = 2.7]
      \draw[->] (-1.2, 0) -- (1.2, 0) node[below left] {$\Re k$};
      \draw[->] (0, -0.5) -- (0, 1.2) node[above] {$\Im k$};
      
	    \tikzstyle{every pin edge}=[shorten <=1pt,]
      \tikzstyle{every pin}=[fill=white,]

        \node at (0, 0.1) [bound, pin=above left:Bound state,] {};
		\node at (0, 0.3) [bound] {};
		
        \node at (0.25, -0.15) [quasibound] {};
        \draw[very thick, mid arrows] 
        (0,0) -- (1,0);
        \draw[thick, mid arrows, dashed]
          (1,0) arc (0:90:1) arc (90:180:1) -- (0,0);
		  
		\node at (0, 0.1) [bound, pin=above left:Bound State,] {};
		\node at (-0.25, -0.15) [quasibound, pin=below left:Resonance,] {};
    \end{tikzpicture}
    }
    \subfloat[]{
    \label{fig:berggren_contour}
    %\tikzset{external/remake next}
  \tikzsetnextfilename{berggren_contour}
    \begin{tikzpicture}[scale = 2.7]
      \draw[->] (-1.2, 0) -- (1.2, 0) node[below left] {$\Re k$};
      \draw[->] (0, -0.5) -- (0, 1.2) node[above] {$\Im k$};
      \foreach \y in {0.1, 0.3}
        \node at (0, \y) [bound] {};
      \foreach \x in {0.25, -0.25}
        \node at (\x, -0.15) [quasibound] {};
        
      \draw[very thick, mid arrows] (0,0) 
         -- (0.25, -0.25) 
         -- (0.5, 0) node[pos=0.25, pin=below right:$L_+$] {} 
         -- (1, 0);
      \draw[thick, mid arrows, dashed, radius=1] (1, 0) 
                arc [start angle=0,  end angle=90]
                arc [start angle=90, end angle=180]
                -- (-0.5, 0) 
                -- (-0.25, 0.25)
                -- (0, 0);
      
    \end{tikzpicture}
    }
    \label{fig:contours}
  }
  \caption{The complex $k$-plane. The circles represent 
  bound states and the triangles resonant states. Note the 
  mirroring of the states in the imaginary axis.}
  \label{fig:complex plane}
\end{figure}

\todo{label on right resonance SPILL}

\todo[inline]{this seems like a big leap of faith?. Ask Jimmy about this subsection?} We now interpret the bound and resonant $k$ as complex poles and the unbound continuum as a contour, mirrored in the imaginary axis, encircling the upper half plane (\cref{fig:simple_contour}).
The integral to be evaluated along the contour is the one in the radial momentum space Schrödinger equation
\begin{eq}
  \frac{k^2}{2\mu}\phi(k) + \fint[0][\inf]{k'} k'^2 V(k,k') \phi(k') 
  &=
  E\phi(k).
\end{eq}
The result of a contour integration depends on the poles it encircles by the residue theorem. 
The contour in \cref{fig:simple_contour} encircles the bound states, but not the resonance.
We suspect a deformation of the contour, such that it encircles the resonance, might have an effect on the solutions.
\todo{Encircle sounds a bit weird? 'Includes'?}

\subsection{The Berggren Completeness Relation}

In fact, this is correct, and was proven in 1968 by Berggren \cite{berggren}.
The contour, dubbed $L_+$, can be deformed to surround the resonance poles, as illustrated in \cref{fig:berggren_contour}. 
The continuum states along $L_+$ combined with the encircled bound and resonant states form a complete basis. 
The result can be stated succinctly in the \emph{Berggren completeness relation} (compare with \cref{eq:momentum_completeness_relation})
\todo{is this ok ref?}
\begin{eq}
  \sum_{\substack{\text{bound} \\ \text{resonant}}} \ket{E_n}\bra{E_n} 
  + \fint[L_+]{k} k^2 \ket{E_k}\bra{E_k} = 1.
\end{eq}
This is an important result, because of the inclusion of the resonances in the basis.\todo[inline]{'the Berggren basis' is thus far undefined}
As we will see in \cref{cha:three-body}, the Berggren basis is what allows us to find resonances in systems with more particles.

\todo[inline]{berättande stil?}
An observant reader may have noticed that the resonant poles in \cref{fig:contours} are mirrored in the imaginary axis and that the contour has a shadow on the left half plane.
Berggren showed that this symmetry allows us to restrict ourselves to the contour segment from 0 to $\inf$. 
However, doing this leads to a new scalar product (and thus norm) that must be used: 
\begin{eq}
  \braket{\phi}{\phi'} = \fint[0][\inf]{k} k^2 \conj{\phi(k)}\phi'(k)
\end{eq}
is replaced by
\begin{eq}
  \label{eq:berggren_product}
  \braket{\phi}{\phi'} = \fint[0][\inf]{k} k^2 \phi(k)\phi'(k)
\end{eq} 
without the conjugation.




\todo{figure markers, romb, kvadrat, cirkel, triangel SPILL}
\section{\He{5} Revisited}

With the complex-momentum basis we can continue our study of the \He{5} system. 
We use the same Woods-Saxon parameters as before, but now use a complex contour.
The solutions will be examined in a similar fashion to \cref{cha:two-body}, using this new tool.

\subsection{The Discretized Complex Contour}

We deform the previously real contour by a triangle-shaped downward extrusion, as in \cref{fig:discretized_contour}. 
The tip of the triangle is placed below the expected position of the resonance pole.
To use the contour in computations it has to be discretized, as before in \cref{sec:discretization}.
We still use the Gauss-Legendre quadrature, but now consider each segment of the contour separately, rescaling the evaluation points and weights between each pair of complex endpoints according to \cref{app:gauss-legendre}.
The discretized contour is seen in \cref{fig:discretized_contour}. 
Note the concentration of points near the ends of each segment, characteristic of the Gauss-Legendre quadrature.

The discretized Schrödinger equation \cref{eq:plane_wave_matrix_elements} is unchanged from before
\begin{eq}
  \label{eq:nhqm matrix element}
  H_{ij}' = \frac{k_i^2}{2\mu}\delta_{ij} + \sqrt{w_i w_j}k_i k_j V_{ij},
\end{eq}
but now the $k$ and $w$ are complex. 
However, when normalizing the obtained eigenvectors, care must be taken to use the new scalar product defined in \cref{eq:berggren_product}.


%\tikzset{external/remake next}
\tikzsetnextfilename{triangle_contour}
\begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      width = \textwidth,
      height = 7cm,
      xlabel=Re $k$,
      ylabel=Im $k$,
		  axis lines = middle,
      ymax = 0.1,
      enlargelimits,
      only marks,
      ticks = none,
      every axis x label/.style={
        at = {(current axis.right of origin)},
        anchor = north,
      },
      ]
      \addplot[color=gray] table {../figures/numerical_contour/numerical_contour.data};
    \end{axis}
  \end{tikzpicture}
  \caption{A schematic picture of the discretized complex contour. The points are distributed on each segment according to the Gauss-Legendre quadrature rule.}
  \label{fig:discretized_contour}
\end{figure}

\subsection{The \He{5} Resonances}

We expect the position of the resonance poles to be fairly close to the experimental data in \cref{tab:}. We then choose the triangular contour so that it extends below the expected position. \Cref{tab:contours} show the poles and the corresponding contours. 

\todo{use $k_r$?}

\todo{different contours, discuss.}
\begin{table}[H]
  \begin{tabular}{l|c|c}
    Wave      & Experimental $k$  & Contour vertices \\
    \hline
    $p_{3/2}$ & 0.1788 -  0.0349i & 
      $(0, 0) \to (0.17, -0.2) \to (0.34, 0) \to (3, 0)$ \si{fm^{-1}} \\
    $p_{1/2}$ & 0.3267 - 0.1643i &
      $(0, 0) \to (0.35, -0.4) \to (0.7, 0) \to (3, 0)$ \si{fm^{-1}} \\
  \end{tabular}
  \caption{Contours used to identify \He{5} resonances.}
  \label{tab:contours}
\end{table}

We solve the Schrödinger equation using the contours and represent the energy solutions by their momenta $k=\sqrt{2\mu E}$. The result for the $p_{3/2}$ wave is shown in \cref{fig:triangle_contour}. We see that most solutions follow the contour, corresponding to non-resonant continuum states, similarly to the real case.

\todo{fill in value}
There is one solution that doesn't lie on the contour, however. 
It has $k = \SI{0.1732-0.03567i}{fm^{-1}}$, which is reasonably close to what we expected for the resonance.
If we have indeed found the resonance, we expect it to be unchanged when the contour is varied.
In \cref{fig:rect_contour}, we have used a rectangular contour instead, yet the pole is completely stable.
We also found that we could vary the depth of the contour without the resonance pole moving, but if we went too far down, the matrix element integrals started to diverge.
Barring such numerical errors, we found that any contour that runs below the pole gives a stable resonance solution.

\todo{double legend? SPILL}

\begin{figure}
  \centering{
    \subfloat[Triangle Contour]{
      \label{fig:triangle_contour}
      \includegraphics[page=2]{../figures/poles(contour)/poles.pdf}
    }
    \\
    \subfloat[Rectangular Contour]{
      \label{fig:rect_contour}
      \includegraphics[page=1]{../figures/poles(contour)/poles.pdf}
    }
  }
   \caption{Momentum solutions for a \He{5} $p_{3/2}$ wave for different contours. The resonance is located at $0.1731, -0.03558i$ for both contours. we have used $V0 =$ \SI{47}{MeV} with $k_{max} =$ \SI{5}{fm^{-1}} with 60 points on both contours.} 
\label{fig:pole(cont)}  
\end{figure}

 


%\tikzset{external/remake next}
\tikzsetnextfilename{pole(V0)}
\begin{figure}
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      width = \textwidth,
      height = 9cm,
        xlabel=Re $k/\b{\si{fm^{-1}}}$,
        ylabel=Im $k/\b{\si{fm^{-1}}}$,
  		  axis x line = middle,
        axis y line = left,
        every axis y label/.style={
          at = {(current axis.above origin)},
          anchor = north west,
        },
        every axis x label/.style={
          at = {(current axis.right of origin)},
          anchor = north east,
        },
 	      yticklabel style={/pgf/number format/fixed,
 	                     /pgf/number format/precision=3},
        every x tick label/.append style = {anchor = south, yshift = 3pt},
        xmax=0.5,
        ytickmax = 0.3, xtickmax = 0.9,
		xtick={0.1,0.2,...,0.4},
        enlarge y limits,
        no markers,
		     xtickmin = 0.1,
		     xticklabel style={/pgf/number format/fixed,
		     /pgf/number format/precision=3},
        ]
      	\addplot+[color = red, very thick, ->] table  {../figures/res_pole(V0)/poles.data};
      	    \addlegendentry{Pole position}
      	\addplot+[color= gray, very thick] table [x index = 0, y index = 1] {../figures/res_pole(V0)/contour.data};
\node[coordinate,pin=above right:{$V_0=54.3$}] 
at (axis cs:0,0.116) {};
          \addlegendentry{Contour}
      \end{axis}
  \end{tikzpicture}
  \caption{The pole position as a function of $V_0$.}
  \label{fig:pole(V0)}
\end{figure}
\todo{make beautiful SPILL}
%%%%%%%%%%%%%%%%%%%%%%%%% V0(CONTOUR) FIGURE


\todo[inline]{Why does the solutions follow the mesh points if they are free? SPILL}
\todo[inline]{same resonance $\Re k$ as before SPILL}

\todo{touch up figure, width etc. SPILL}

\subsubsection{Momentum Space Wavefunctions}

\todo{repeat? PONTUS}

In addition we can investigate the wavefunctions of these solutions. 
\Cref{fig:complex_mom_wavefunctions} shows the momentum distribution of an arbitrary unbound solution and the resonance. We also show the corresponding situation when using the real basis, for comparison. Note how the resonance wavefunction is much more distinguished in the complex basis.  
The unbound solution still correspond to one definite (now complex) momentum. 
On the other hand, the resonance has a broad distribution, reflecting the localized nature of the solution 
(remember Heisenberg --- a broad momentum wavefunction allows a localized position wavefunction). 
In principle, this feature also gives us a way to automatically find the resonance among a large set of solutions: 
simply single out the one with the broadest wavefunction, or equivalently after normalization, with the lowest maximum value.
\todo{move the two-body chapter} 

%%%%%%%%%%%%%%%%%%%%%%%%%WF real/complex FIGURE

\begin{figure}[H]
\centering{
	\subfloat[Momentum space wavefunctions with a real contour.]{
  		\includegraphics[page=1]{../figures/eigvecs_real_comp/eigvecs.pdf}
	}
	\\
	\subfloat[Momentum space wavefunctions with a complex contour.]{
  		\includegraphics[page=2]{../figures/eigvecs_real_comp/eigvecs.pdf}
	}
  }
\caption{\He{5} momentum probability distributions for a real and complex contour. The resonance is more prominent when solving along the complex contour but is significantly wider than the surrounding states in both cases. Both contours comprise 60 points in total, but the points in the complex contour are focused near the origin. The density fluctuation stems from the gauss-legedre distribution on the individual segments.} 
\label{fig:complex_mom_wavefunctions}
\end{figure}

\todo{figurtext! SPILL}

%%%%%%%%%%%%%%%%%%%%%%%%%WF real/complex end


We can now properly investigate how the solutions change as the potential is varied. \Cref{fig:pole(V0)} shows how the solutions vary as $V_0$ 
is successively changed from \SI{70}{MeV}, where the potential well can contain a bound state, to \SI{50}{MeV}, where no bound states exist. 
As the potential well grows less attractive, we see that the imaginary part $\Gamma$ of the resonance energy increases, and thus the half-time of the quasi-bound state becomes shorter. 

\subsection{Fitting to Experimental Resonance Data} 

We may now proceed to fit our model of \He{5} to experimental data of the $p_{3/2}$ and  $p_{1/2}$ resonance provided by \cite{tunl}, giving values 
\todo{fix citation OLA}
\todo{Make tables? One table \cancel{showing} \emph{to rule} them all? OLA}

\begin{tabular}{l r r}
  $p_{3/2}:$ & $E_0 = 0.798,$ & $\Gamma = 0.648$\\
  $p_{1/2}:$ & $E_0 = 2.068,$ & $\Gamma = 5.57$ \\
\end{tabular}\\
Fitting the parameters $V_0$ and $V\sub{so}$ to these four data points give a best fit when

$V_0 = 47.0490019$ and $V\sub{so} = -7.03992575$,\\
where we get the computed values $bla bla$ for the $p_{3/2}$ resonance and $bla bla$ for the $p_{1/2}$ resonance.

\todo{p1/2 figur SPILL OLA MAYBE NOT NEEDED}

\todo{search and destroy pole position SPILL}

\todo{figures where they belong. Wednesday night: fixa uppslag med figur + tillhörande text}

\todo{in captions: solutions in the complex momentum plane SPILL}

\end{document}
