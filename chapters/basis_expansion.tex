We want to study the nuclei of Helium isotopes by solving the \emph{Time Independent Schrödinger Equation} (TISE)
\begin{eq}
  \label{eq:TISE}
  H \ket\psi = E \ket\psi,
\end{eq}
commonly written in the position basis as \todo{Position or coordinate?}
\begin{eq}
  \label{eq:TISEpos}
  \p{-\frac{\hbar^2}{2m}\nabla^2 + V(\vec{r})}\psi(\vec{r}) = E\psi(\vec{r}).
\end{eq}

For the nuclear systems we are looking at, the TISE has no known analytical solutions, and we need to use numerical methods to solve it.
However, written as in \cref{eq:TISEpos}, it is not suitable for numerical calculations.
Instead, we would  like to write it as a matrix equation
\begin{eq}
  \label{eq:matrix equation}
  \sum_j H_{ij}\psi_j = E \psi_i
\end{eq}
with a finite matrix $H$ that we can diagonalize to find the eigenvalues $E$.

To write the TISE as a matrix equation we use \emph{basis expansion}. 
Basis expansion is how we make sense of the abstract Hilbert spaces, operators and state vectors of Quantum Mechanics (QM). 
By expanding these abstract objects in a basis, we can relate them to the physical world. 
For example, \cref{eq:TISEpos} is the TISE for a single particle, expanded in the position basis. 
We will not expand in the position basis, but it will still be important, since it is the only basis in which we can express the potential.

Before we begin, we briefly recap some well known QM facts. 
First we need a \emph{complete basis}, either discrete $\ket{n}$ or continuous $\ket{x}$. 
A discrete basis means that any state $\ket\psi$ can be written as a linear combination of the basis states
\begin{eq}
  \label{eq:lincomb}	
  \ket\psi = \sum_n \psi_n \ket{n}
  \quad
  \textup{or}
  \quad
  \ket\psi = \fint{x} \psi(x) \ket{x}.
\end{eq}
The complete bases we will use in this report are the \emph{position basis} $\ket{\vec{r}}$, the \emph{plane wave basis} $\ket{\vec{k}}$, the \emph{harmonic oscillator basis} $\ket{nlm}$ and the elusive \emph{Berggren basis} \cite{berggren}. All these bases are orthonormal, i.e. all the basis vectors satisfy 
\begin{eq}
  \braket{n}{n'} = \delta_{nn'}
  \quad
  \textup{or}
  \quad
  \braket{x}{x'} = \delta(x - x').
\end{eq}
With a complete basis $\ket{n}$, we get the very useful \emph{completeness relation}
\begin{eq}
  I = \sum_n \ket{n} \bra{n}
  \quad
  \textup{or}
  \quad
  I = \fint{x} \ket{x}\bra{x},
\end{eq}
where $I$ is the identity operator. This relation can thus be inserted anywhere in any equation, and will find frequent use in this report. 

Let us now expand the TISE in the abstract $\ket{n}$ basis. We start by inserting the completeness relation for $\ket{n}$ in \cref{eq:TISE}
\begin{eq}
  \label{eq:expand1}
  H
  \p{
    \sum_{n'} \ket{n'} \bra{n'}
  }
  \ket\psi
  =
  \sum_{n'} H \ket{n'} \braket{n'}{\psi}
  =
  E \ket\psi.
\end{eq}
By closing \cref{eq:lincomb} with $\bra{n}$ on the left side and use orthonormality, we see that $\braket{n'}{\psi} = \psi_{n'}$. Now we close \cref{eq:expand1} with $\bra{n}$ on the left
\begin{eq}
  \label{eq:expand2}
  \sum_{n'} \bra{n} H \ket{n'} \psi_{n'}
  = 
  E \braket{n}{\psi},
\end{eq}
and if we write $H_{nn'} = \bra{n} H \ket{n'}$, we get
\begin{eq}
  \label{eq:expand3}
  \sum_{n'} H_{nn'} \psi_{n'} = E \psi_n,
\end{eq}
which is equivalent to the matrix \cref{eq:matrix equation}. This is 
the basic method of expanding the TISE in a basis.

\section{Spherical Symmetry}
\label{sec:spherical symmetry}

We limit ourselves to spherically symmetric systems, i.e. systems with a potential $V(r)$ that only depends on the distance $r$ from the origin. This is sufficient for our purposes and, indeed, most common QM problems. If we considered three-dimensional systems with arbitrary potentials, the problem space \todo{is problem space the right term?} would grow very fast and would be infeasible to calculate on a computer.

The spherical symmetry allows us to write the wavefunction $\psi(\vec{r})$ as a product of a radial wavefunction $R(r)$ and the spherical harmonics $Y_l^m$
\begin{eq}
  \psi(\vec{r}) = R(r) Y_l^m(\theta, \phi).
\end{eq}
Here $l$ and $m$ are the quantum numbers for the orbital angular momentum and its projection along an arbitrary $z$-axis. 
Their corresponding operators, $L^2$ and $L_z$, commute with the Hamiltonian $H$, which means that 
\todo{Hjälp? Hur skriver vi det här på bästa sätt?}

Since we are considering a spherically symmetric Hamiltonian
the $l$ and $m$ in $\ket{nlm}$ commute with $H$
and will therefore contribute with a $\delta_{ll'}\delta_{mm'}$ factor. 
This means we can drop the primes and write \cref{eq:HOexpanded} as
\begin{eq}
  \sum_{n'} \bra{nlm} H \ket{n'lm} \psi_{n'lm} = E\psi_{nlm}.
\end{eq}
If we see $\bra{nlm} H \ket{n'lm} = H_{nn'}$ as a matrix, this can be expressed as {\it $H$ is diagonal in $l$ and $m$}.
\todo{gammalt stuff för inspiration}

\section{The Harmonic Oscillator Basis}
\label{sec:harmosc}

We now expand the TISE in the spherically symmetric Harmonic Oscillator (HO) basis. The basis consists of the eigenstates $\ket{nlm}$ of the HO Hamiltonian
\begin{eq}
  \label{eq:HO hamiltonian}
  H\sub{HO} = \frac{p^2}{2\mu} + \frac{\mu\omega^2 r^2}{2},
\end{eq}
where $\mu$ is the mass of the problem and $\omega$ is the angular frequency of the oscillator. 
The expansion procedure is the same as in \cref{eq:expand1,eq:expand2,eq:expand3} and gives us
\begin{eq}
  \label{eq:HOexpanded}
  \sum_{n'l'm'} \bra{nlm} H \ket{n'l'm'} \psi_{n'l'm'} = E \psi_{nlm}
\end{eq}
and if we use the fact that $H$ is diagonal in $l$ and $m$ we get
\begin{eq}
  \sum_{n'} \bra{nlm} H \ket{n'lm} \psi_{n'lm} = E\psi_{nlm}.
\end{eq}
We now have a matrix equation, but we need to find the matrix elements $\bra{nlm} H \ket{n'lm}$. These require some calculation (see \cref{sec:HO matrix elements} for the details) and the result is
\begin{eq}
  \label{eq:HO matrix elements}
  &
  \bra{nlm} H \ket{n'lm} =
	\frac{\hbar\omega}{2}
	\left(
    \p{2n+l+\frac{3}{2}} \delta_{nn'}
    +
		\sqrt{n(n+l+\frac{1}{2})} \delta_{n,n'-1}\right.
		\\ & + 
		\left.\sqrt{n'(n'+l+\frac{1}{2})} \delta_{n',n-1} 
	\right)
	+
	\fint[0][\inf]{r} 
    r^2 R_{nl}(r) V(r) R_{n'l}(r)
\end{eq}
where $R_{nl}$ are the radial wavefunctions of the harmonic oscillator
\begin{eq}
  \label{eq:HO radial wavefunction}
	R_{nl}(r) 
	= 
  \sqrt{\frac{
    2^{l+2} \gamma^{l + 3/2} (n - l)!!
  }{
    \sqrt\pi (n + l + 1)!!
  }}
	r^l e^{-\gamma r^2 / 2}
	L_{(n-l) / 2}^{(l+\frac{1}{2})}(\gamma r^2),
\end{eq}
$\gamma = \mu\omega/\hbar$ and $L_\mu^\nu(x)$ are the generalized Laguerre polynomials.
\todo{Doublecheck normalization constant.}
The real space wavefunction $R(r)$ for a state will be expressed as a linear combination of the harmonic oscillator radial wavefunctions:
\begin{eq}
  R(r) = \sum_n \psi_{nlm} R_{nl}(r).
\end{eq}

\subsection{Numerical Considerations}
\todo{Is this really needed?}
Since the HO basis is a discrete basis, adapting the formulas for calculation on a computer is straightforward. 
There are a few considerations, however, and we mention them here. 

The $\ket{nlm}$ basis is infinite in $n$, but we need a finite matrix, we thus truncate the basis to $N$ basis states, giving us an $N \times N$ matrix.
Since the matrix is diagonal in $l$ and $m$, we do the calculation separately for each value of $l$ and $m$ to reduce the amount of computation needed to solve for the eigenvalues.
The equation we are solving is then, for a given $l$ and $m$,
\begin{eq}
  \sum_{n'= 0}^N \bra{n} H \ket{n'} \psi_{n'} = E\psi_{n},
\end{eq}
or in matrix notation
\begin{eq}
  H\psi = E\psi.
\end{eq}
This matrix equation is solved using a standard eigensolver algorithm, which uses the fact that the matrix is hermitian to solve the equation faster.

We calculate the matrix elements using \cref{eq:HO matrix elements}. 
The integration is performed using the Gauss-Legendre quadrature and setting the upper limit to a finite number. \todo{is this the first mention of GL-int? yes. yes it is.}


\section{The Plane Wave Basis}
\label{sec:mom_space}

The plane wave basis $\ket{\vec{k}}$ is of great importance for us since we are studying a system with a short-range potential supporting only a few, if any, bound solutions. 
This means that we will find multiple unbound solutions, corresponding to free particles with various momenta.
These are almost eigenstates of the momentum operator, only slightly disturbed by the small potential well at $r=0$. 

The expansion is done in the same way as before, giving us
\begin{eq}
  \int \rd^3 \vec{k}' \bra{\vec{k}} H \ket{\vec{k}'} \Phi(\vec{k}')
  &= 
  E\Phi(\vec{k}) \, .
\end{eq}
This three-dimensional equation is practically unsolvable, but we can simplify it using the fact that we have a central problem. 
A rather involved calculation (see \cref{sec:radial mom space TISE}) shows that the Schrödinger equation can be written as
\begin{eq} 
  \label{eq:radial mom space TISE}
  \frac{k^2}{2\mu}\phi(k) + \fint[0][\inf]{k} k'^2 V(k,k') \phi(k') 
  &=
  E\phi(k) \, ,
\end{eq}
where $\phi(k)$ is the radial part of the momentum space wavefunction, 
\begin{eq}
  V(k,k') 
  &= 
  \frac{2}{\pi}\int_0^\infty \rd r \, r^2 V(r) j_l(kr) j_l(k'r) 
\end{eq}
and $j_l(kr)$ are the spherical bessel functions of order $l$. $\phi(k)$ is related to the real space radial wavefunction by
\begin{eq}
R(r)=i^l\sqrt{\frac{2}{\pi}} \fint[0][\inf]{k} k^2 \phi(k)j_l(kr).
\end{eq}

\subsection{Discretization}
The integral equation \cref{eq:radial mom space TISE} can be rewritten as a matrix equation through discretization, turning the integral into a sum over a finite set of points $k_j$ and $\rd{k}$ into a set of weights $w_j$:
\todo{Maybe this delta trickery is unnecessary. Do it after discretization.}
\begin{eq}
  \label{eq:discrete_momentum}
  \frac{k_i^2}{2\mu} \phi(k_i)
  +
  \sum_{j=1}^N w_j
    k_j^2 V(k_i,k_j)
  \phi(k_j)
  =
  E \phi(k_i)
  .
\end{eq}
A particular set of points and corresponding weights is called a \emph{quadrature}, and the choice of quadrature greatly impacts the precision of the result. 
A naïve quadrature with evenly spaced $k_j = j\Delta k$ and a constant weight $w_j=\Delta k$ converges slowly, and should not be used. 
We instead use the Gauss-Legendre quadrature \cite{gauss-legendre}.
\todo{Gauss-Legendre appendix?}

With this approximation the Schrödinger equation may be written as
\begin{eq}
  \sum_j H_{ij} \phi_j &= E \phi_i
\end{eq}
where $\phi_i=\phi(k_i)$ and 
\begin{align}
  \label{eq:mom matrix}
  H_{ij} &= \frac{k_i^2}{2\mu}\delta_{ij} + w_jk_j^2 V_{ij} \\
  V_{ij} &= \frac{2}{\pi} \int_0^\infty \rd r \, r^2 V(r) j_l(k_i r) j_l(k_j r)
\end{align}

Because of the $k_j^2$ in the second term of the matrix elements 
(\cref{eq:mom matrix}), the $H_{ij}$ matrix will not be symmetric. 
Working with a symmetric matrix will be faster, hence we perform 
the transformation
\begin{eq}
  \phi_i &\mapsto
  \phi_i' =  \sqrt{w_i} k_i \phi_i
  \\
  H_{ij} &\mapsto
  H_{ij}' 
  = 
  \sqrt{\frac{w_i}{w_j}} \frac{k_i}{k_j}H_{ij},
\end{eq}
which gives us a symmetric matrix
\begin{eq}
  H_{ij}' = \frac{k_i^2}{2\mu}\delta_{ij} + \sqrt{w_i w_j}k_i k_j V_{ij}.
\end{eq}
The Shrödinger equation then becomes
\begin{eq}
  \sum_j H'_{ij}\phi'_j = E\phi'_i \, ,
\end{eq}
with the same eigenvalues $E$, meaning that we can work with the symmetric $H'_{ij}$ matrix.
 The real space radial wavefunction $R(r)$ is expressed in terms of $\phi'_j$ as
\begin{eq}
  R(r)
  =
  i^l 
  \sqrt{\frac{2}{\pi}}
  \sum_{j=1}^N 
    \sqrt{w_j}k_j \phi'_j j_l(k_j r).
\end{eq}

\section{Verifying with the Hydrogen Atom} \todo{Did we decide to not have this? Maybe in appendix?}

To test our HO and momentum-space bases, we expand the well-known 
hydrogen atom. It has the potential
\begin{eq}
  \label{eq:hydrogen potential}
	V(r)=
	-\frac{q_e^2}{4\pi \epsilon_0 r},
\end{eq}
\todo{Change to ``Number of basis states in the expansion'' or $N$ in figure.}
and is analytically solvable with a ground state energy 
$E_0 = -\SI{13.6}{eV}$. In \cref{fig:hydrogen HOvsMom} we plot 
the convergence of the ground state energy as a function of $N$.
We see that the plane-wave expansion converges faster than the 
harmonic oscillator, but toward the wrong value.
\todo{verify this and write it in a better fashion}
This is because the momentum space expansion does not 
support the use of infinite potentials, and since 
\cref{eq:hydrogen potential} diverges as $r \to 0$,  
a small deviation is not surprising.

\begin{figure}
  \hspace{-2cm}
    \includegraphics[width = 1.25\textwidth]{figures/hydrogen_convergence.pdf}
  \caption{Ground state energy of hydrogen atom as a function of $N$, the number of states included in the basis.}
  \label{fig:hydrogen HOvsMom}
\end{figure}


