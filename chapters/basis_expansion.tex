We want to study the nuclei of Helium isotopes by solving the time independent Schr√∂dinger equation (TISE)
\begin{eq}
  \label{eq:TISE}
  H \ket\psi = E \ket\psi.
\end{eq}
The TISE is commonly written in the position basis as
\begin{eq}
  \label{eq:TISEpos}
  \p{-\frac{\hbar^2}{2m}\nabla^2 + V(\vec{r})}\psi(\vec{r}) = E\psi(\vec{r}),
\end{eq}
since this is the only basis where the potential operator $V$ is known.

For the nuclear systems we are looking at, the TISE has no known analytical solutions, and we need to use numerical methods to solve it. However, written as in \cref{eq:TISEpos}, it is not suitable for numerical calculations. Instead, we would  like to write it as a matrix equation
\begin{eq}
  \label{eq:matrix equation}
  \sum_j H_{ij}\psi_j = E \psi_i
\end{eq}
with a finite matrix $H$ that we can diagonalize to find the eigenvalues $E$.

To write the TISE as a matrix equation we use \emph{basis expansion}. Basis expansion is how we make any sense at all of the abstract Hilbert spaces, operators and state vectors of QM. By expanding these abstract objects in a basis, we can relate them to the physical world. For example, equation \cref{eq:TISEpos} is the TISE for a particle, expanded in the position basis. This is the only basis in which we can express the potential, why wel always have to relate our new bases to this one.

Before we begin, we briefly recap some well known QM facts. First we need a \emph{complete basis}, either discrete $\ket{n}$ or continuous $\ket{x}$. A discrete basis means that any state $\ket\psi$ can be written as a linear combination of the basis states
\begin{eq}
  \label{eq:lincomb}	
  \ket\psi = \sum_n \psi_n \ket{n}
  \quad
  \textup{or}
  \quad
  \ket\psi = \fint{x} \psi(x) \ket{x}.
\end{eq}
The complete bases we will use in this report are the \emph{position basis} $\ket{\vec{r}}$, the \emph{momentum basis} $\ket{\vec{k}}$, the \emph{harmonic oscillator basis} $\ket{nlm}$ and the elusive \emph{Berggren basis} \cite{berggren}. All these bases are orthonormal, i.e. all the basis vectors satisfy 
\begin{eq}
  \braket{n}{n'} = \delta_{nn'}
  \quad
  \textup{or}
  \quad
  \braket{x}{x'} = \delta(x - x').
\end{eq}
With a complete basis $\ket{n}$, we get the very useful \emph{completeness relation}
\begin{eq}
  I = \sum_n \ket{n} \bra{n}
  \quad
  \textup{or}
  \quad
  I = \fint{x} \ket{x}\bra{x},
\end{eq}
where $I$ is the identity operator. This relation can therefore be inserted anywhere in any equation, and will find frequent use in this report. 

Let's now expand the TISE in the abstract $\ket{n}$ basis. We start by inserting the completeness relation for $\ket{n}$ in \cref{eq:TISE}
\begin{eq}
  \label{eq:expand1}
  H
  \p{
    \sum_{n'} \ket{n'} \bra{n'}
  }
  \ket\psi
  =
  \sum_{n'} H \ket{n'} \braket{n'}{\psi}
  =
  E \ket\psi.
\end{eq}
By closing \cref{eq:lincomb} with $\bra{n}$ on the left side and using orthonormality, we see that $\braket{n'}{\psi} = \psi_{n'}$. Now we close \cref{eq:expand1} with $\bra{n}$ on the left
\begin{eq}
  \label{eq:expand2}
  \sum_{n'} \bra{n} H \ket{n'} \psi_{n'}
  = 
  E \braket{n}{\psi},
\end{eq}
and if we write $H_{nn'} = \bra{n} H \ket{n'}$, we get
\begin{eq}
  \label{eq:expand3}
  \sum_{n'} H_{nn'} \psi_{n'} = E \psi_n,
\end{eq}
which is equivalent to the matrix \cref{eq:matrix equation}. This is the basic method of expanding the TISE in a basis. Expanding in an abstract basis won't get us very far, however, so we move on to the epitomic example: the harmonic oscillator.

\section{The Spherical Harmonic Oscillator}

The Helium nuclei we want to expand are, for our intents and purposes, spherically symmetric. A spherically symmetric basis is therfore preferable, and we begin with the spherical harmonic oscillator (HO). The treatment below is adapted from \cite{moshinsky}.

We have for the HO, the Hamiltonian
\begin{eq}
  \label{eq:HO hamiltonian}
  H\sub{HO} = \frac{p^2}{2\mu} + \frac{\mu\omega^2 r^2}{2},
\end{eq}
where $\mu$ is the mass of the problem and $\omega$ is the angular frequency of the oscillator. With this Hamiltonian, the TISE has the solutions
\begin{eq}
  H\sub{HO}\ket{nlm} = E_{nl}\ket{nlm} % E_{nl}???
\end{eq}
with
\begin{eq}
  E_{nl} = \hbar\omega(2n + l + \frac{3}{2}), \quad n = 0, 1, 2, \dots
\end{eq}
This means $\ket{nlm}$ is a complete basis (WHY????), and it is the basis we will expand our TISE in. The procedure is the same as in \cref{eq:expand1,eq:expand2,eq:expand3} and gives us
\begin{eq}
  \label{eq:HOexpanded}
  \sum_{n'l'm'} \bra{nlm} H \ket{n'l'm'} \psi_{n'l'm'} = E \psi_{nlm}\,.
\end{eq}
Since we are considering a spherically symmetric Hamiltonian
\begin{eq}
  \label{eq:spherical hamiltonian}
  H = \frac{p^2}{2\mu} + V(r),
\end{eq}
the $l$ and $m$ in $\ket{nlm}$ commute with the Hamiltonian and will therefore contribute with a $\delta_{ll'}\delta_{mm'}$ factor. This means we can drop the primes and write \cref{eq:HOexpanded} as
\begin{eq}
  \sum_{n'} \bra{nlm} H \ket{n'lm} \psi_{n'lm} = E\psi_{nlm}.
\end{eq}
If we see $\bra{nlm} H \ket{n'lm} = H_{nn'}$ as a matrix, this can be expressed as {\it $H$ is diagonal in $l$ and $m$}.

Now we have our matrix equation, but we need to find the elements $\bra{nlm} H \ket{n'lm}$. These require some calculation (see \cref{sec:HO matrix elements} for the details) and the result is
\begin{eq}
  \label{eq:HO matrix elements}
  &
  \bra{nlm} H \ket{n'lm} =
	\frac{\hbar\omega}{2}
	\left(
    \p{2n+l+\frac{3}{2}} \delta_{nn'}
    +
		\sqrt{n(n+l+\frac{1}{2})} \delta_{n,n'-1}\right.
		\\ & + 
		\left.\sqrt{n'(n'+l+\frac{1}{2})} \delta_{n',n-1} 
	\right)
	+
	\fint[0][\inf]{r} 
    r^2 R_{nl}(r) V(r) R_{n'l}(r)
\end{eq}
where $R_{nl}$ are the radial wavefunctions of the harmonic oscillator
\begin{eq}
  \label{eq:HO radial wavefunction}
	R_{nl}(r) 
	= 
	N r^l e^{-\gamma r^2 / 2}
	L_{(n-l) / 2}^{(l+\frac{1}{2})}(\gamma r^2)
\end{eq}
with $\gamma = \mu\omega/\hbar$, $L_n^\alpha(x)$ are the generalized Laguerre polynomials and $N$ is a normalization constant,
\begin{eq}
	N = 
  \sqrt{\frac{
    2^{n+l+2}\gamma^{l+\frac{3}{2}}
  }{
    \sqrt{\pi}
  }}
  \sqrt{\frac{
    \p{\frac{1}{2}(n-l)}!
    \p{\frac{1}{2}(n+l)}!
  }{
    (n+l+1)!
  }}.
\end{eq}

\subsection{Implementation}

Since the HO basis is a discrete basis, implementing it in code is straightforward. There are a few considerations, however, and we mention them here. 

The $\ket{nlm}$ basis is infinite in $n$, but we need a finite matrix to carry out calculations on. The solution is to truncate the basis with a finite number $N$, giving us an $N \times N$ matrix. Since the matrix is diagonal in $l$ and $m$, we do the calculation separately for each value of $l$ and $m$ to reduce the amount of computation needed to find the eigenvalues.
The equation we are solving is then, for a given $l$ and $m$,
\begin{eq}
  \sum_{n'= 0}^N \bra{n} H \ket{n'} \psi_{n'} = E\psi_{n}
\end{eq}
or in linear algebra notation
\begin{eq}
  H\psi = E\psi.
\end{eq}
This matrix equation is solved using a standard eigensolver algorithm, which uses the fact that the matrix is hermitian to solve the equation faster.

The matrix elements are calculated using \cref{eq:HO matrix elements}. The integration is performed using Gauss-Legendre quadrature and setting the upper limit to a finite number.

% section the_spherical_harmonic_oscillator (end)
