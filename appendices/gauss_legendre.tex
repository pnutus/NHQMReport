\documentclass[../main/report.tex]{subfiles}
\begin{document}

\section{The Gauss-Legendre Quadrature Rule}
\label{app:gauss-legendre}

An integral can be computed numerically by turning it into a sum
\begin{eq}
  \int_a^b f(x) \id{x} \approx \sum_{i=1}^n w_i f(x_i)
\end{eq}
where the integrand is evaluated at a discrete set of points $x_i$ and multiplied by corresponding weights $w_i$.
The choice of points and weights is called a \emph{quadrature rule}.

The Gauss-Legendre quadrature rule is efficient for computing integrals with finite limits.
The theory behind the rule is involved and can be found in e.g. \cite{gl}. 
The idea is to pick points $x_i$ on the $[-1,1]$ interval that are roots of the Legendre polynomial of a certain degree n and approximate the integral with
\begin{eq}
  \int_{-1}^1 f(x)\id{x} \approx \sum_{i=1}^n w_i f(x_i).
\end{eq}
with the weights given by \cite{abramowitz+stegun}
\begin{eq}
  w_i = \frac{2}{\left( 1-x_i^2 \right) [P'_n(x_i)]^2}
\end{eq}
where $P_n$ is the Legendre polynomial of degree $n$. 
This can be rescaled for any definite integral
\begin{eq}
	\int_a^b f(x)\,dx 
  \approx 
  \frac{b-a}{2} \sum_{i=1}^n w_i f
    \p{
    \frac{b-a}{2}x_i + \frac{a+b}{2}
    }.
\end{eq}
It can be shown that this quadrature gives the exact answer for all polynomials of degree up to $2n-1$. 
The only requirement for convergence is that the integrand can be approximated by a polynomial on the interval.
In some cases, as with singular functions, that is not possible, but for the functions encountered in this work it is a safe approximation.

\end{document}