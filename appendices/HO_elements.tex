\section{Harmonic Oscillator Matrix Elements}
\label{sec:HO matrix elements}

First, we express the Hamiltonian $H$ of our problem in terms of $H\sub{HO}$ (\cref{eq:HO_hamiltonian}) to get
\begin{eq}
  H = H\sub{HO} - \frac{\mu\omega^2 r^2}{2} + V(r).
\end{eq}
We then close this equation with $\bra{nlm}$ on the left and 
$\ket{n'lm}$ on the right to get three terms on the RHS, which 
we consider in turn. The first is just the eigenvalues of $H\sub{HO}$
\begin{eq}
  \bra{nlm} H\sub{HO} \ket{n'lm} 
  = 
  E_{nl} \braket{nlm}{n'lm} 
  = 
  \hbar\omega\p{2n + l + \frac{3}{2}} \delta_{nn'}.
\end{eq}
The second follows from the known identity \cite{moshinsky}
\begin{eq}
	& \bra{nlm} r^2 \ket{n'lm} 
	= \\
	& \frac{\hbar}{\mu\omega}
  \p{
  	\p{2n + l + \frac{3}{2}}\delta_{nn'}
    -
  	\sqrt{n(n+l+\frac{1}{2})}\delta_{n,n'-1}
  	-
  	\sqrt{n'(n'+l+\frac{1}{2})}\delta_{n',n-1}
  }.
\end{eq}
The third term is calculated in the position basis, with
\begin{eq}
  \braket{\vec{r}}{nlm} = R_{nl}(r) Y_l^m(\theta, \phi),
\end{eq}
where $R_{nl}$ is the HO radial wavefunctions (see \cref{eq:HO_radial_wavefunction}) and $Y_l^m$ are the spherical harmonics. Because $V(r)$ is spherically symmetric, the spherical harmonics integrate to 1 and we get
\begin{eq}
	\bra{nlm} V(r) \ket{n'lm} 
	=
	\fint[0][\inf]{r} r^2 R_{nl}(r)  V(r) R_{n'l}(r).
\end{eq}
Putting it all together, we have
\begin{eq}
  \bra{nlm} H \ket{n'lm} 
  & =
  \bra{nlm} H\sub{HO} - \frac{\mu\omega^2 r^2}{2} + V(r) \ket{n'lm}
  \\ & =
	\frac{\hbar\omega}{2}
	\left(
    \p{2n+l+\frac{3}{2}} \delta_{nn'}
    +
		\sqrt{n(n+l+\frac{1}{2})} \delta_{n,n'-1}\right.
		\\ & + 
		\left.\sqrt{n'(n'+l+\frac{1}{2})} \delta_{n',n-1} 
	\right)
	+
	\fint[0][\inf]{r} 
    r^2 R_{nl}(r) V(r) R_{n'l}(r).
\end{eq}