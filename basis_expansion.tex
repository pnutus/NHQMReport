We want to study the nuclei of Helium isotopes by solving the time independent Schr√∂dinger equation (TISE)
\begin{eq}
  \label{eq:TISE}
  H \ket\psi = E \ket\psi.
\end{eq}
The TISE is commonly written in the position basis as
\begin{eq}
  \label{eq:TISEpos}
  \p{-\frac{\hbar^2}{2m}\nabla^2 + V(\vec{r})}\psi(\vec{r}) = E\psi(\vec{r}),
\end{eq}
since this is the basis where we know how to express the potential operator $V$. 

For the nuclear systems we are looking at, the TISE has no known analytical solutions, we need to use numerical methods to solve it. However, written as in \eqref{eq:TISEpos}, it is not suitable for numerical calculations. We would  like instead to write it as a matrix equation, with a finite matrix $H$ that we can diagonalize to find the eigenvalues $E$.

One way to write the TISE as a matrix equation is to use \emph{basis expansion}. Basis expansion is how we make any sense at all of the abstract Hilbert spaces, operators and state vectors of QM. By expanding these abstract objects in a basis we can relate them to the physical world. Equation \eqref{eq:TISEpos} is the TISE for a particle, expanded in the position basis. This is the only basis in which we can express the potential, so we have to start there, but we can expand that equation into another basis.

First we need a \emph{complete basis}, either discrete $\ket{n}$ or continuous $\ket{x}$, which means that any state $\ket\psi$ can be written as a linear combination of the basis states
\begin{eq}
  \ket\psi = \sum_n c_n \ket{n}
  \quad
  \textup{or}
  \quad
  \ket\psi = \fint{x} \psi(x) \ket{x}.
\end{eq}
The complete bases we will use in this report are the \emph{position basis} $\ket{\vec{r}}$, the \emph{momentum basis} $\ket{\vec{k}}$, the \emph{harmonic oscillator basis} $\ket{nlm}$ and the elusive \emph{Berggren basis}. All these bases are orthonormal, i.e. all the basis vectors satisfy 
\begin{eq}
  \braket{n}{n'} = \delta_{nn'}
  \quad
  \textup{or}
  \quad
  \braket{x}{x'} = \delta(x - x').
\end{eq}

With a complete basis $\ket{n}$, we get the very useful \emph{completeness relation}
\begin{eq}
  I = \sum_n \ket{n} \bra{n}
  \quad
  \textup{or}
  \quad
  I = \fint{x} \ket{x}\bra{x},
\end{eq}
where $I$ is the identity operator. This relation can therefore be inserted anywhere in any equation, and will find frequent use in this report.


\newpage

The Schrodinger equation, describing the dynamics of a quantum system, is written in terms of abstract Hilbert space vectors, as
\begin{eq}
	ih\ddt\ket\psi = H\ket\psi
\end{eq}
This is a meaningless statement, until you define what the vectors mean. We will avoid going into a detailed discussion of possible interpretations of the state vectors, and simply take the pragmatic position of stating that they are defined by how they are acted upon by operators. In the extension, this is equivalent to knowing what their \emph{representation} is in a basis. Let us investigate what is meant by that statement.

Consider an arbitrary operator $A$, corresponding to a physical observable quantity. By this it is understood that the operator is \emph{hermitian}. It has a set of eigenvectors $\ket{a_n}$, 
\begin{eq}
	A \ket{a_i} = a_i \ket{a_i}
\end{eq}
and from the hermiticity of the operator it follows that the set of eigenvectors form an orthonormal basis. This means that an arbitrary vector can be written as
\begin{eq}
	\ket{\psi}=\sum_i c_i\ket{a_i}
\end{eq}
Closing the equation with the bra $\bra{a_j}$ and using the orthonormality of the basis you get
\begin{eq}
	c_j=\braket{a_j}{\psi}
\end{eq}
and from this you immediately get the important \emph{completeness relation}, by inserting the expression into the previous equation.
\begin{eq}
	\ket\psi 
	= 
	\sum_i \ket{a_i}\braket{a_i}{\psi} 
	= 
	\p{
		\sum_i\ket{a_i}\bra{a_i} 
	} 
	\ket\psi
\end{eq} 
and we see that we have the identity $I=\sum_i\ket{a_i}\bra{a_i}$. We can now evaluate what we get when $\ket{\psi}$ is acted upon by another arbitrary operator $B$.
\begin{eq}
	\ket\phi = B\ket\psi = \sum_j B\ket{a_j}\braket{a_j}{\psi}
\end{eq}
Closing this equation with $\ket{a_i}$ gives us 
\begin{eq}
	\phi_i=\sum_j B_{ij}\psi_j
\end{eq}
where $B_{ij}=\bra{a_i} B \ket{a_j}$ and $\psi_j=\braket{a_j}{\psi}$. We identify this as a matrix equation, $\phi = B\psi$. This $\psi$ is the representation of the state vector $\ket\psi$ in the $\ket{a_i}$-basis, or A-basis. Similarly $B$ is the representation of the operator $B$. Assuming that the matrix $\{B_{ij}\}$ is known (or at least knowable), we see that our definition of a state vector is indeed equivalent to knowing the representation $\psi$ in any basis.

For the reader, this method of representing a vector in a basis is perhaps most familiar in the case of the position basis. This is a continuous basis, so the sums above must be replaced by integrals. Let us use our new knowledge to rewrite the time-independent Schrodinger equation in position basis. We start with
\begin{eq}
	H \ket\psi = E \ket\psi
\end{eq}
By closing with $\bra{x}$ from the left and using the orthonormality of the $\ket{x}$ basis to write $\ket{\psi} = \int_\minf^\inf \rd x' \, \ket{x'}\braket{x'}{\psi}$ we get, using the notation $\psi(x)=\braket{x}{\psi}$,
\begin{eq}
	\int_\minf^\inf \rd x'\bra{x} H \ket{x'} \psi(x') = E\psi(x)
\end{eq}
Assuming that the hamiltonian $H$ can be written as $H = \frac{p^2}{2m} + V(x)$, a careful analysis [SEE APPENDIX? Meaningless but fun calculation] shows that its representation in the position basis is such that the equation is reduced to
\begin{eq}
	-\frac{\hbar^2}{2m}\nabla^2\psi(x)+V(x)\psi(x)=E\psi(x)
\end{eq}
which is exactly the famous time-independent Schrodinger wave equation.

\subsection{Harmonic Oscillator Basis}
For numerical calculation it is of interest to use the eigenstates of the spherical harmonic oscillator hamiltonian $H\sub{HO}$ as basis vectors. This is because $H\sub{HO}$ is an analytically solvable system with spherical symmetry, that can locally approximate any potential with a minimum near $r=0$. We have
\begin{eq}
	H\sub{HO} = \frac{p^2}{2\mu} + \frac{\mu\omega^2r^2}{2}
	\label{HO hamil}
\end{eq}
The momentum operator $p^2$ can be separated into a angular and radial part, giving for a system of angular momentum l
\begin{eq}
	H\sub{HO}=\frac{p_r^2}{2\mu}+\frac{\hbar^2l(l+1)}{2\mu r^2}+\frac{\mu\omega^2r^2}{2}
\end{eq}
where the position basis representation of $p_r^2$ is
\begin{eq}
	p_r^2=-\hbar^2\frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial}{\partial r}\right)
\end{eq}
It can be shown \cite{HO} that the eigenstates $\ket{nlm}$ of $H\sub{HO}$ form a discrete basis, 
\begin{eq}
	H\sub{HO}\ket{nlm}=E_n\ket{nlm}
	\label{HOeigeneq}
\end{eq}
with 
\begin{eq}
	E_n = \hbar\omega(2n + l + \frac{3}{2})
\end{eq}
The position basis representation of the eigenstates are
\begin{eq}
	\braket{\vec{r}}{nlm} = R_{nl}(r) Y_l^m(\theta, \varphi)
\end{eq}
where $Y_l^m$ are the spherical harmonics, and $R_{nl}$ is the radial wavefunction
\begin{eq}
	R_{nl}(r) 
	= 
	N_{nl} r^l e^{-\gamma r^2 / 2}
	L_{(n-l) / 2}^{(l+\frac{1}{2})}(\gamma r^2)
\end{eq}
where $\gamma = \frac{\mu\omega}{\hbar}$, $L(x)$ are the generalized Laguerre polynomials and $N_{nl}$ is a normalization constant,
\begin{eq}
	N_{nl}=\sqrt{\frac{2^{n+l+2}\gamma^{l+\frac{3}{2}}}{\sqrt{\pi}}}\sqrt{\frac{\left(\frac{1}{2}(n-l)\right)!\left(\frac{1}{2}(n+l)\right)!}{(n+l+1)!}}
\end{eq}
This can be used in the solution of a general central problem, described by a hamiltonian
\begin{eq}
	H=\frac{p^2}{2\mu}+V(r)
\end{eq}
The eigenstates of $H\sub{HO}$ form a ON-basis, so following the reasoning of the previous section we can write an arbitrary state $\ket{\psi}$ with given angular momentum $l$ and $m$ as
\begin{eq}
	\ket{\psi}=\sum_{n'=0}^\infty c_{n'lm}\ket{n'lm}
\end{eq}
The TISE can then be written, closing it with $\bra{nlm}$,
\begin{eq}
	\sum_{n'} \bra{nlm} H \ket{n'lm} \psi_{n'lm} = E\psi_{nlm}
\end{eq}
If we can figure out what the hamilton matrix is, we have now stated the problem in the harmonic oscillator basis. Let's have a look at 
\begin{eq}
	\bra{nlm} H \ket{n'lm} = \bra{nlm} \frac{p^2}{2\mu} \ket{n'lm} + \bra{nlm}V(r)\ket{n'lm}
\end{eq}
By considering equation \eqref{HO hamil} and \eqref{HOeigeneq} we find that the first term can be written as
\begin{eq}
	\bra{nlm} \frac{p^2}{2\mu} \ket{n'lm} 
	= 
	\bra{nlm} H\sub{HO} \ket{n'lm} 
	- 
	\bra{nlm} \frac{\mu\omega^2 r^2}{2} \ket{n'lm}
\end{eq}
Now, the first term is trivial since the basis vectors are eigenstates of $H\sub{HO}$, giving a contribution of 
$\hbar\omega(2n + l + \frac{3}{2}) \delta_{n,n'}$. 
The second one is trickier, but there is a known identity \cite{Moshinsky} stating
\begin{eq}
	\bra{nlm} r^2 \ket{n'lm} 
	& = 
	\frac{\hbar}{\mu\omega} 
	\p{2n + l + \frac{3}{2}}
	\\ & -
	\frac{\hbar}{\mu\omega} 
	\p{
		\sqrt{n(n+l+\frac{1}{2})}\delta_{n,n'-1}
		+
		\sqrt{(n+1)(n+l+\frac{3}{2})}\delta_{n,n'+1})
	}
\end{eq}
All that is left to evaluate is the term $\bra{nlm} V(r) \ket{n'lm}$, which is suitably calculated in position basis. Because of the spherical symmetry of the potential, the spherical harmonics will fall straight through, and you are simply left with
\begin{eq}
	\bra{nlm} V(r) \ket{n'lm} 
	= 
	\int_0^\inf \rd r\, r^2 R_{nl}(r) R_{n'l}(r) V(r)
\end{eq}
Inserting all of this, you find that the matrix elements are given by %DOUBLE CHECK THIS EQUATION, is the factor m omega^2/2 correct? uncertain on the factor 2
\begin{eq}
	H_{n,n'} 
	& = 
	\bra{nlm} H \ket{n'lm} 
	\\ & =
	\frac{\hbar\omega}{2} (2n+l+\frac{3}{2})
	+
	\frac{m\omega^2}{2}
	\left(
		\sqrt{n(n+l+\frac{1}{2})} \delta_{n,n'-1}\right.
		\\ & + 
		\left.\sqrt{(n+1)(n+l+\frac{3}{2})} \delta_{n,n'+1} 
	\right)
	+
	\int_0^\inf \rd r\, r^2 R_{nl}(r) R_{n'l}(r) V(r)
	\label{HO elements}
\end{eq}
and once these matrix elements are known, the TISE can be written as an infinite linear system of equations,
\begin{eq}
	H \psi = E \psi
\end{eq}
$H$ being the matrix with elements $H_{n,n'}$ and $\psi$ a vector with elements $\psi_n = \braket{nlm}{\psi}$.

If the potential is such that the matrix elements cannot analytically be calculated, you will need to use numerical methods to solve the equation. It is understandably inconvenient with an infinite array of equations, hence you need to somehow truncate the matrix. This is done by truncating the expansion
\begin{eq}
	\ket\psi = \sum_n^N c_{nlm} \ket{nlm}
\end{eq}
at a finite $N$. It can be shown that this truncation is equivalent to a least-squares approximation of the state \cite{Sandvik}. After calculating the matrix elements in the way prescribed above, solving the eigenvalue equation is equivalent to diagonalizing the $N\times N$ matrix thus obtained.

If you find the eigenvectors $\psi$ like this, you can retrieve the coordinate space wave functions as
\begin{eq}
	\psi(r) = 
\end{eq}
etc.

%ADD SECTION: verifying the above results with an example -- the hydrogen atom. Showing convergence with respect to N etc.
